---
tags:
  - DB
date created: 2021-12-06 23:10
date updated: 2021-12-06 23:14
---

Теорема касается трех взаимосвязанных требований, существующих в большой распределенной системе данных:

- **Согласованность** - все клиенты должны прочитать одно и то же значение в ответ на один и тот же запрос, даже если одновременно с этим производятся обновления.
- **Доступность** - все клиенты базы данных всегда имеют возможность читать и записывать данные. Мы не можем ждать для этого завершения каких-либо операций.
- **Устойчивость к разделению** - базу данных можно разделить между несколькими машинами; более того, она продолжит работу даже в случае отказа сегмента сети.

CAP-теорема утверждает, что в любой системе можно гарантированно обеспечить выполнение только двух из этих трех требований.

> аналог «Программа может быть хорошей, быстрой и дешевой — выбирай любые два свойства».

Чем большая согласованность требуется от системы, тем меньше будет ее устойчивость к разделению.

Однако в распределенной системе сетевые сбои очень вероятны. Мы не можем избежать задержек и потерь пакетов, обрыва связанности, вплоть до того, что часть распределенной базы данных оказывается изолированной от другой. Поэтому избежать узла устойчивости к разделению в современных веб-приложениях почти невозможно. Таким образом, любая СУБД может располагаться лишь на одной грани CAP-треугольника. Точнее это зависит от режима работы СУБД, так как часто многие СУБД могут располагаться на той или иной грани.

Традиционные реляционные СУБД, спроектированные для работы на одном компьютере, обеспечивают согласованность и доступность. Они с трудом могут обеспечивать устойчивость к разделению. Как видите, MySQL, PostgreSQL, реляционные базы данных находятся на грани CA (согласованность и доступность). Существуют сторонние решения и от Google и от компании Percona, которые позволяют перевести базу данных MySQL на грань CP, т. е., обеспечить согласованность данных и устойчивость к разделению. Однако в этом случае страдает доступность: мы вынуждены дожидаться операции обновления базы данных.

> ![[Снимок экрана 2021-12-06 в 23.14.00.png]]

Существует большое количество самых разнообразных NoSQL-решений, которые находятся на разных гранях этого треугольника. Они специально созданы для решения проблемы CAP-теоремы.

Укрупнение проектов, распределенная структура современных веб-решений приводит к тому, что требуются новые решения, новые базы данных, которые, обеспечивая меньшую согласованность, остаются устойчивыми в разделению.
Именно этим вызван интерес к современным NoSQL-базам данных, которые компенсируют слабую приспособленность реляционных баз данных к распределенной работе.

В том числе поэтому в современных приложениях традиционную реляционную СУБД зачастую сопровождают одна или несколько NoSQL-баз данных. Реляционная СУБД выступает в качестве основного хранилища, NoSQL-базы данных решают специализированные задачи или обеспечивают сетевую связность в условиях нестабильной сети.
